# ============================================================
# Device  : FW3523AB0002
# Model   : EX4400
# Host    : sw-access-02
# Generated: 2026-02-19 13:34:32
# ============================================================

# ---- SYSTEM HARDENING ────────────────────────────────── #
set system host-name sw-access-02
set system domain-name corp.example.com

set system login announcement "AUTHORIZED ACCESS ONLY. Unauthorized access is prohibited and monitored."

set system root-authentication ssh-rsa "ssh-rsa AAAAB3NzaC1yc2EAAA... netops-jumphost"

set system login password minimum-length 14
set system login password change-type set-transitions 0
set system login password format sha512

set system login retry-options tries-before-disconnect 3
set system login retry-options backoff-threshold 1
set system login retry-options backoff-factor 5
set system login retry-options minimum-time 20
set system login retry-options lockout-period 5

set system login user netadmin class super-user
set system login user netadmin authentication ssh-rsa "ssh-rsa AAAAB3NzaC1yc2EAAA... netadmin"

set system services ssh root-login deny
set system services ssh protocol-version v2
set system services ssh max-sessions-per-connection 1
set system services ssh connection-limit 5
set system services ssh rate-limit 5
set system services ssh ciphers [ aes128-ctr aes192-ctr aes256-ctr ]
set system services ssh macs [ hmac-sha2-256 hmac-sha2-512 ]
set system services ssh key-exchange [ ecdh-sha2-nistp256 ecdh-sha2-nistp384 ]
set system services ssh hostkey-algorithm [ ecdsa-sha2-nistp256 ecdsa-sha2-nistp384 ssh-rsa ]
delete system services telnet
delete system services ftp
delete system services finger
delete system services rlogin
delete system services rsh


delete system services web-management

set firewall family inet filter PROTECT-RE term ALLOW-SSH from source-address 10.0.0.0/24 172.16.10.0/24 
set firewall family inet filter PROTECT-RE term ALLOW-SSH from protocol tcp
set firewall family inet filter PROTECT-RE term ALLOW-SSH from destination-port 22
set firewall family inet filter PROTECT-RE term ALLOW-SSH then accept
set firewall family inet filter PROTECT-RE term ALLOW-SNMP from source-address 10.0.0.100/32 
set firewall family inet filter PROTECT-RE term ALLOW-SNMP from protocol udp
set firewall family inet filter PROTECT-RE term ALLOW-SNMP from destination-port 161
set firewall family inet filter PROTECT-RE term ALLOW-SNMP then accept
set firewall family inet filter PROTECT-RE term ALLOW-NTP from protocol udp
set firewall family inet filter PROTECT-RE term ALLOW-NTP from destination-port 123
set firewall family inet filter PROTECT-RE term ALLOW-NTP then accept
set firewall family inet filter PROTECT-RE term ALLOW-TACACS from source-address 10.0.0.50/32 10.0.0.51/32 
set firewall family inet filter PROTECT-RE term ALLOW-TACACS from protocol tcp
set firewall family inet filter PROTECT-RE term ALLOW-TACACS from destination-port 49
set firewall family inet filter PROTECT-RE term ALLOW-TACACS then accept
set firewall family inet filter PROTECT-RE term ALLOW-ICMP from protocol icmp
set firewall family inet filter PROTECT-RE term ALLOW-ICMP from icmp-type [ echo-request echo-reply ]
set firewall family inet filter PROTECT-RE term ALLOW-ICMP then accept
set firewall family inet filter PROTECT-RE term DENY-ALL then discard
set firewall family inet filter PROTECT-RE term DENY-ALL then log
set firewall family inet filter PROTECT-RE term DENY-ALL then syslog

set interfaces lo0 unit 0 family inet filter input PROTECT-RE

set system syslog file security-log any any
set system syslog file security-log structured-data

set system authentication-order [ tacplus password ]

set system ddos-protection global bandwidth-scale 10
set system ddos-protection global burst-scale 10


set system no-redirects
set system arp aging-timer 5
set system internet-options no-source-quench
set system internet-options no-tcp-reset drop-all-tcp

# ---- INTERFACES ──────────────────────────────────────── #
set vlans DATA vlan-id 10
set vlans DATA description "User Data VLAN"
set vlans DATA l3-interface irb.10
set vlans VOICE vlan-id 20
set vlans VOICE description "VoIP VLAN"
set vlans AP vlan-id 30
set vlans AP description "Wireless APs"
set vlans MGMT vlan-id 99
set vlans MGMT description "Infrastructure Management"
set vlans MGMT l3-interface irb.99
set vlans UNUSED vlan-id 999
set vlans UNUSED description "Parking VLAN for unused ports"

set interfaces irb unit 10 description "SVI-DATA"
set interfaces irb unit 10 family inet address 10.10.20.1/24
set interfaces irb unit 99 description "SVI-MGMT"
set interfaces irb unit 99 family inet address 10.99.1.1/24

set interfaces me0 unit 0 description "OOB-MANAGEMENT"
set interfaces me0 unit 0 family inet address 10.0.0.12/24
set routing-options static route 0.0.0.0/0 next-hop 10.0.0.254

set interfaces ge-0/0/0 description "PC-FLOOR3-DESK001"
set interfaces ge-0/0/0 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/0 unit 0 family ethernet-switching vlan members DATA
set poe interface ge-0/0/0 priority low
set interfaces ge-0/0/0 unit 0 family ethernet-switching storm-control access-sc
set protocols rstp interface ge-0/0/0 edge
set protocols rstp interface ge-0/0/0 no-root-port
set interfaces ge-0/0/1 description "PC-FLOOR3-DESK002"
set interfaces ge-0/0/1 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/1 unit 0 family ethernet-switching vlan members DATA
set interfaces ge-0/0/1 unit 0 family ethernet-switching storm-control access-sc
set protocols rstp interface ge-0/0/1 edge
set protocols rstp interface ge-0/0/1 no-root-port
set interfaces ge-0/0/2 description "PC-FLOOR3-DESK003"
set interfaces ge-0/0/2 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/2 unit 0 family ethernet-switching vlan members DATA
set interfaces ge-0/0/2 unit 0 family ethernet-switching storm-control access-sc
set protocols rstp interface ge-0/0/2 edge
set protocols rstp interface ge-0/0/2 no-root-port
set interfaces ge-0/0/10 description "PHONE-FLOOR3-001"
set interfaces ge-0/0/10 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/10 unit 0 family ethernet-switching vlan members VOICE
set poe interface ge-0/0/10 priority high
set poe interface ge-0/0/10 maximum-power 15400
set interfaces ge-0/0/10 unit 0 family ethernet-switching storm-control access-sc
set protocols rstp interface ge-0/0/10 edge
set protocols rstp interface ge-0/0/10 no-root-port
set interfaces ge-0/0/11 description "PHONE-FLOOR3-002"
set interfaces ge-0/0/11 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/11 unit 0 family ethernet-switching vlan members VOICE
set poe interface ge-0/0/11 priority high
set interfaces ge-0/0/11 unit 0 family ethernet-switching storm-control access-sc
set protocols rstp interface ge-0/0/11 edge
set protocols rstp interface ge-0/0/11 no-root-port
set interfaces ge-0/0/18 description "AP-FLOOR3-001"
set interfaces ge-0/0/18 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/18 unit 0 family ethernet-switching vlan members AP
set poe interface ge-0/0/18 priority high
set poe interface ge-0/0/18 maximum-power 30000
set interfaces ge-0/0/18 unit 0 family ethernet-switching storm-control access-sc
set protocols rstp interface ge-0/0/18 edge
set protocols rstp interface ge-0/0/18 no-root-port
set interfaces ge-0/0/22 description "MGMT-SERVER-03"
set interfaces ge-0/0/22 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/22 unit 0 family ethernet-switching vlan members MGMT
set poe interface ge-0/0/22 disable
set interfaces ge-0/0/22 unit 0 family ethernet-switching storm-control access-sc
set protocols rstp interface ge-0/0/22 edge
set protocols rstp interface ge-0/0/22 no-root-port
set interfaces ge-0/0/23 description "MGMT-SERVER-04"
set interfaces ge-0/0/23 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/23 unit 0 family ethernet-switching vlan members MGMT
set poe interface ge-0/0/23 disable
set interfaces ge-0/0/23 unit 0 family ethernet-switching storm-control access-sc
set protocols rstp interface ge-0/0/23 edge
set protocols rstp interface ge-0/0/23 no-root-port

set interfaces ge-0/0/3 description "UNUSED-DISABLED"
set interfaces ge-0/0/3 disable
set interfaces ge-0/0/3 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/3 unit 0 family ethernet-switching vlan members UNUSED
set interfaces ge-0/0/4 description "UNUSED-DISABLED"
set interfaces ge-0/0/4 disable
set interfaces ge-0/0/4 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/4 unit 0 family ethernet-switching vlan members UNUSED
set interfaces ge-0/0/5 description "UNUSED-DISABLED"
set interfaces ge-0/0/5 disable
set interfaces ge-0/0/5 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/5 unit 0 family ethernet-switching vlan members UNUSED
set interfaces ge-0/0/6 description "UNUSED-DISABLED"
set interfaces ge-0/0/6 disable
set interfaces ge-0/0/6 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/6 unit 0 family ethernet-switching vlan members UNUSED
set interfaces ge-0/0/7 description "UNUSED-DISABLED"
set interfaces ge-0/0/7 disable
set interfaces ge-0/0/7 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/7 unit 0 family ethernet-switching vlan members UNUSED
set interfaces ge-0/0/8 description "UNUSED-DISABLED"
set interfaces ge-0/0/8 disable
set interfaces ge-0/0/8 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/8 unit 0 family ethernet-switching vlan members UNUSED
set interfaces ge-0/0/9 description "UNUSED-DISABLED"
set interfaces ge-0/0/9 disable
set interfaces ge-0/0/9 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/9 unit 0 family ethernet-switching vlan members UNUSED
set interfaces ge-0/0/12 description "UNUSED-DISABLED"
set interfaces ge-0/0/12 disable
set interfaces ge-0/0/12 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/12 unit 0 family ethernet-switching vlan members UNUSED
set interfaces ge-0/0/13 description "UNUSED-DISABLED"
set interfaces ge-0/0/13 disable
set interfaces ge-0/0/13 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/13 unit 0 family ethernet-switching vlan members UNUSED
set interfaces ge-0/0/14 description "UNUSED-DISABLED"
set interfaces ge-0/0/14 disable
set interfaces ge-0/0/14 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/14 unit 0 family ethernet-switching vlan members UNUSED
set interfaces ge-0/0/15 description "UNUSED-DISABLED"
set interfaces ge-0/0/15 disable
set interfaces ge-0/0/15 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/15 unit 0 family ethernet-switching vlan members UNUSED
set interfaces ge-0/0/16 description "UNUSED-DISABLED"
set interfaces ge-0/0/16 disable
set interfaces ge-0/0/16 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/16 unit 0 family ethernet-switching vlan members UNUSED
set interfaces ge-0/0/17 description "UNUSED-DISABLED"
set interfaces ge-0/0/17 disable
set interfaces ge-0/0/17 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/17 unit 0 family ethernet-switching vlan members UNUSED
set interfaces ge-0/0/19 description "UNUSED-DISABLED"
set interfaces ge-0/0/19 disable
set interfaces ge-0/0/19 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/19 unit 0 family ethernet-switching vlan members UNUSED
set interfaces ge-0/0/20 description "UNUSED-DISABLED"
set interfaces ge-0/0/20 disable
set interfaces ge-0/0/20 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/20 unit 0 family ethernet-switching vlan members UNUSED
set interfaces ge-0/0/21 description "UNUSED-DISABLED"
set interfaces ge-0/0/21 disable
set interfaces ge-0/0/21 unit 0 family ethernet-switching interface-mode access
set interfaces ge-0/0/21 unit 0 family ethernet-switching vlan members UNUSED


set interfaces et-0/0/24 description "UPLINK-CORE-SW01-et-0/0/2"
set interfaces et-0/0/24 unit 0 family ethernet-switching interface-mode trunk
set interfaces et-0/0/24 unit 0 family ethernet-switching vlan members [ DATA VOICE AP MGMT ]
set interfaces et-0/0/24 unit 0 family ethernet-switching native-vlan-id 99
set interfaces et-0/0/24 speed 25g
set interfaces et-0/0/24 gigether-options autonegotiation
set interfaces et-0/0/25 description "UPLINK-CORE-SW01-et-0/0/3"
set interfaces et-0/0/25 ether-options 802.3ad ae0
set interfaces et-0/0/25 speed 25g
set interfaces et-0/0/25 gigether-options autonegotiation
set interfaces et-0/0/26 description "UPLINK-CORE-SW02-et-0/0/2"
set interfaces et-0/0/26 ether-options 802.3ad ae0
set interfaces et-0/0/26 speed 25g
set interfaces et-0/0/26 gigether-options autonegotiation
set interfaces et-0/0/27 description "UNUSED-DISABLED"
set interfaces et-0/0/27 unit 0 family ethernet-switching interface-mode trunk
set interfaces et-0/0/27 unit 0 family ethernet-switching vlan members [ UNUSED ]
set interfaces et-0/0/27 gigether-options autonegotiation
set interfaces et-0/0/27 disable


set interfaces ae0 description "LAG-TO-CORE-SW01"
set interfaces ae0 aggregated-ether-options lacp active
set interfaces ae0 aggregated-ether-options lacp periodic fast
set interfaces ae0 aggregated-ether-options minimum-links 1
set interfaces ae0 unit 0 family ethernet-switching interface-mode trunk
set interfaces ae0 unit 0 family ethernet-switching vlan members [ DATA VOICE AP MGMT ]
set interfaces ae0 unit 0 family ethernet-switching native-vlan-id 99


set forwarding-options storm-control-profiles access-sc all bandwidth-level 10
set forwarding-options storm-control-profiles access-sc all no-unknown-unicast
set forwarding-options storm-control-profiles uplink-sc all bandwidth-level 50

set protocols rstp bridge-priority 32k
set protocols rstp bpdu-block-on-edge

set protocols lldp port-id-subtype interface-name
set protocols lldp interface all
set protocols lldp-med interface all

# ---- NTP ─────────────────────────────────────────────── #
set system time-zone Europe/London

set ntp authentication-key 1 type sha1 value "NTPsecretKey123!"
set ntp authenticate
set ntp trusted-key [ 1 ]

set ntp server 10.0.0.1 version 4 prefer
set ntp server 10.0.0.2 version 4

set ntp source-address 10.0.0.12

# ---- SYSLOG ──────────────────────────────────────────── #
set system syslog console kernel emergency
set system syslog console any critical

set system syslog file messages any notice
set system syslog file messages authorization info
set system syslog file messages structured-data

set system syslog file interactive-commands interactive-commands any
set system syslog file interactive-commands structured-data

set system syslog file security-events authorization any
set system syslog file security-events kernel any
set system syslog file security-events firewall any
set system syslog file security-events structured-data
set system syslog file security-events archive size 10m files 5

set system syslog file change-log change-log any
set system syslog file change-log structured-data

set system syslog host 10.0.0.200 any any
set system syslog host 10.0.0.200 port 514
set system syslog host 10.0.0.200 structured-data
set system syslog host 10.0.0.200 explicit-priority

set system syslog source-address 10.0.0.12

set system syslog time-format year

# ---- TACACS ──────────────────────────────────────────── #
set system tacplus-server 10.0.0.50 secret "TacacsSecret123!"
set system tacplus-server 10.0.0.50 port 49
set system tacplus-server 10.0.0.50 timeout 5
set system tacplus-server 10.0.0.50 single-connection
set system tacplus-server 10.0.0.51 secret "TacacsSecret123!"
set system tacplus-server 10.0.0.51 port 49
set system tacplus-server 10.0.0.51 timeout 5
set system tacplus-server 10.0.0.51 single-connection

set system tacplus-options tacplus-server-timeout 5
set system tacplus-options source-address 10.0.0.12

set system authentication-order [ tacplus password ]

set system accounting events [ login change-log interactive-commands ]
set system accounting destination tacplus

set system login user emergency class super-user
set system login user emergency authentication encrypted-password "$6$rounds=65536$..."

set system login class read-only permissions view view-configuration
set system login class read-only deny-commands "(request|set|delete|rename|copy|load|save|start|stop|run|restart)"
set system login class network-admin permissions all

# ---- SNMPV3 ──────────────────────────────────────────── #
set snmp location "DC1-Floor2-Rack6"
set snmp contact "netops@corp.example.com"
set snmp engine-id local 0x0102030406

set snmp v3 usm local-engine user snmpv3user authentication-sha authentication-password "AuthPass@2024!"
set snmp v3 usm local-engine user snmpv3user privacy-aes128 privacy-password "PrivPass@2024!"

set snmp v3 vacm security-to-group security-model usm security-name snmpv3user group snmp-read-group

set snmp v3 vacm access group snmp-read-group default-context-prefix security-model usm security-level privacy read-view all-view notify-view all-view

set snmp view all-view oid 1 include

set snmp v3 target-address nms-server address 10.0.0.100
set snmp v3 target-address nms-server port 162
set snmp v3 target-address nms-server tag-list trap-tag
set snmp v3 target-parameters nms-server parameters security-model usm security-level privacy security-name snmpv3user
set snmp v3 target-parameters nms-server notify-filter all

set snmp v3 notify trap-notify type trap
set snmp v3 notify trap-notify tag trap-tag

delete snmp community

